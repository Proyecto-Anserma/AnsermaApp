<div class="container">
  <div class="row">
    <div class="col-1">.col-1</div>
    <div class="col-10">
      <br><br><br>
      <h1>Solicitudes</h1>
      <br><br>
      
      <div class="row g-3 align-items-center">
        <div class="col-auto">
          <label for="descripcionFiltro" class="col-form-label">Descripción</label>
          <input type="text" [(ngModel)]="descripcionFiltro" name="descripcionFiltro" id="descripcionFiltro" class="form-control">
        </div>
        <div class="col-auto">
          <label for="cedulaFiltro" class="col-form-label">Cédula</label>
          <input type="text" [(ngModel)]="cedulaFiltro" name="cedulaFiltro" id="cedulaFiltro" class="form-control">
        </div>
        
        <div class="col-auto">
          <button type="submit" class="btn btn-success" (click)="consultarPorDato()" [disabled]="loading">Buscar</button>
        </div>  
        <div class="col-auto">
          <button type="button" class="btn btn-secondary" (click)="limpiarFiltros()">Limpiar</button>
        </div>
        <div class="col-auto">
          <button type="button" class="btn btn-primary" (click)="abrirModalCrear()">Crear Solicitud</button>
        </div>
      </div>
      <div *ngIf="loading" class="mt-3">Cargando...</div>
      <div *ngIf="!loading && solicitudes.length > 0" class="mt-3">
        <table class="table table-striped">
          <thead>
            <tr>
              <th scope="col">Descripción</th>
              <th scope="col">Cédula Ciudadano</th>
              <th scope="col">Fecha de Creación</th>
              <th scope="col">Tipo de Solicitud</th>
              <th scope="col">Estado Actual</th>
              <th scope="col">Acciones</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let solicitud of solicitudes">
              <td>{{ solicitud.descripcion_solicitud }}</td>
              <td>{{ solicitud.id_ciudadano_solicitud }}</td>
              <td>{{ solicitud.fecha_creacion_solicitud | date: 'yyyy-MM-dd' }}</td>
              <td>{{ solicitud.tipo_solicitud?.descripcion_tipo_solicitud }}</td>
              <td>
                {{ getUltimoEstado(solicitud)?.estado?.descripcion_estado || 'Sin estado' }}
              </td>
              <td class="d-flex justify-content-evenly">
                <button class="btn btn-link p-0 text-reset" title="Ver detalles"
                        (click)="abrirModalDetalles(solicitud)">
                  <i class="bi bi-eye-fill"></i>
                </button>
                <button class="btn btn-link p-0 text-reset" title="Editar" 
                        (click)="abrirModalEditar(solicitud)">
                  <i class="bi bi-pencil-fill"></i>
                </button>
                <button class="btn btn-link p-0 text-reset" title="Eliminar"
                        (click)="abrirModalEliminar(solicitud)">
                  <i class="bi bi-trash-fill"></i>
                </button>
              </td>              
            </tr>
          </tbody>
        </table>
      </div>
      <div *ngIf="!loading && solicitudes.length === 0" class="mt-3">
        <p>No se encontraron solicitudes.</p>
      </div>
    </div>
    <div class="col-1">.col-1</div>
  </div>
</div>
